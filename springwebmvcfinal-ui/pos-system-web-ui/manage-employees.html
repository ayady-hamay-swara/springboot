<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Employees - POS System</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap-reboot.min.css">
    <link rel="stylesheet" href="css/bootstrap-grid.min.css">
    <link rel="stylesheet" href="css/manage-employees.css">
</head>
<body>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <a class="navbar-brand" href="index.html">üè™ POS System</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="manage-customers.html">Customers</a></li>
                <li class="nav-item"><a class="nav-link" href="manage-items.html">Items</a></li>
                <li class="nav-item"><a class="nav-link" href="manage-categories.html">Categories</a></li>
                <li class="nav-item active">
                    <a class="nav-link" href="manage-employees.html">Employees <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item"><a class="nav-link" href="pos-checkout.html">üõí POS Checkout</a></li>
                <li class="nav-item"><a class="nav-link" href="place-order.html">Orders</a></li>
                <li class="nav-item"><a class="nav-link" href="search-orders.html">Search</a></li>
            </ul>
        </div>
    </nav>

    <!-- ACCESS DENIED OVERLAY (shown to cashiers) -->
    <div id="accessDeniedOverlay" style="display:none;">
        <div style="text-align:center; padding: 100px 20px;">
            <div style="font-size: 80px;">‚õî</div>
            <h1 class="text-danger mt-3">Access Denied</h1>
            <p class="lead">You do not have permission to view this page.</p>
            <div class="alert alert-warning d-inline-block">
                <strong>Required Access Level:</strong> Owner, Manager, or Assistant Manager
            </div>
            <br><br>
            <a href="pos-checkout.html" class="btn btn-primary btn-lg">Go to POS Checkout</a>
            <a href="index.html" class="btn btn-secondary btn-lg ml-2">Go to Dashboard</a>
        </div>
    </div>

    <!-- MAIN CONTENT (hidden until access check passes) -->
    <div id="mainContent" style="display:none;">
        <div class="container mt-4">

            <!-- Page Title with Access Badge -->
            <div class="row">
                <div class="col-12 d-flex justify-content-between align-items-center">
                    <h2 class="page-title">üë• Employee Management</h2>
                    <div>
                        <span class="badge badge-info p-2" id="currentUserBadge">
                            üë§ Loading...
                        </span>
                        <span class="badge badge-success p-2 ml-2" id="accessLevelBadge">
                            üîì Access Level: --
                        </span>
                    </div>
                </div>
            </div>
            <hr>

            <!-- Statistics Cards -->
            <div class="row mt-3">
                <div class="col-md-3">
                    <div class="card stat-card" style="border-left: 4px solid #2E75B6; background: linear-gradient(135deg,#fff 0%,#f0f7ff 100%); box-shadow: 0 4px 15px rgba(0,0,0,.1); border-radius: 12px;">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div style="font-size:48px;">üë•</div>
                            <div>
                                <h6 class="text-muted mb-1">Total Employees</h6>
                                <h2 id="totalEmployees" class="mb-0">0</h2>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stat-card" style="border-left: 4px solid #28a745; background: linear-gradient(135deg,#fff 0%,#e6f7e6 100%); box-shadow: 0 4px 15px rgba(0,0,0,.1); border-radius: 12px;">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div style="font-size:48px;">‚úÖ</div>
                            <div>
                                <h6 class="text-muted mb-1">Active Staff</h6>
                                <h2 id="activeEmployees" class="mb-0">0</h2>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stat-card" style="border-left: 4px solid #ffc107; background: linear-gradient(135deg,#fff 0%,#fff9e6 100%); box-shadow: 0 4px 15px rgba(0,0,0,.1); border-radius: 12px;">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div style="font-size:48px;">üíº</div>
                            <div>
                                <h6 class="text-muted mb-1">Managers</h6>
                                <h2 id="totalManagers" class="mb-0">0</h2>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card stat-card" style="border-left: 4px solid #dc3545; background: linear-gradient(135deg,#fff 0%,#fff0f0 100%); box-shadow: 0 4px 15px rgba(0,0,0,.1); border-radius: 12px;">
                        <div class="card-body d-flex align-items-center gap-3">
                            <div style="font-size:48px;">üí∞</div>
                            <div>
                                <h6 class="text-muted mb-1">Monthly Payroll</h6>
                                <h2 id="totalPayroll" class="mb-0" style="font-size:22px;">Rs. 0</h2>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Employee Form Card -->
            <div class="row mt-4">
                <div class="col-md-12">
                    <div class="card" style="border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,.1); border:none;">
                        <div class="card-header bg-primary text-white" style="border-radius:12px 12px 0 0;">
                            <h5 class="mb-0">üìù Employee Information</h5>
                        </div>
                        <div class="card-body">
                            <form id="employeeForm">

                                <!-- ROW 1: ID, Name, Position, Status -->
                                <div class="row">
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label for="txtEmployeeId">Employee ID</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="txtEmployeeId"
                                                       placeholder="E001" readonly>
                                                <div class="input-group-append">
                                                    <button class="btn btn-outline-secondary" type="button"
                                                            id="btnGenerateId">üîÑ</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label for="txtName">Full Name <span class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="txtName"
                                                   placeholder="Enter full name" required>
                                        </div>
                                    </div>

                                    <!-- POSITION DROPDOWN (new!) -->
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label for="txtPosition">Position <span class="text-danger">*</span></label>
                                            <select class="form-control" id="txtPosition" required>
                                                <option value="">Select position</option>
                                                <option value="OWNER">üëë Owner</option>
                                                <option value="MANAGER">üíº Manager</option>
                                                <option value="ASSISTANT_MANAGER">üìã Assistant Manager</option>
                                                <option value="CASHIER">üßæ Cashier</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label for="txtStatus">Status</label>
                                            <select class="form-control" id="txtStatus">
                                                <option value="true">Active</option>
                                                <option value="false">Inactive</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label for="txtSalary">Salary (Rs.) <span class="text-muted">(Optional)</span></label>
                                            <input type="number" class="form-control" id="txtSalary"
                                                   placeholder="0.00" step="0.01" min="0">
                                        </div>
                                    </div>
                                </div>

                                <!-- ROW 2: Email, Phone, Hire Date -->
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label for="txtEmail">Email <span class="text-muted">(Optional)</span></label>
                                            <input type="email" class="form-control" id="txtEmail"
                                                   placeholder="employee@example.com">
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label for="txtPhone">Phone <span class="text-muted">(Optional)</span></label>
                                            <input type="text" class="form-control" id="txtPhone"
                                                   placeholder="0771234567">
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label for="txtHireDate">Hire Date <span class="text-muted">(Optional)</span></label>
                                            <input type="date" class="form-control" id="txtHireDate">
                                        </div>
                                    </div>
                                </div>

                                <!-- ROW 3: LOGIN CREDENTIALS (new!) -->
                                <div class="row">
                                    <div class="col-12">
                                        <hr>
                                        <h6 class="text-primary font-weight-bold">
                                            üîê Login Credentials
                                            <small class="text-muted font-weight-normal"> ‚Äî Used by this employee to log into the system</small>
                                        </h6>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label for="txtUsername">Username <span class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="txtUsername"
                                                   placeholder="e.g. john_doe" required>
                                            <small class="form-text text-muted">Employee uses this to log in</small>
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label for="txtPassword">Password <span class="text-danger" id="passwordRequired">*</span></label>
                                            <div class="input-group">
                                                <input type="password" class="form-control" id="txtPassword"
                                                       placeholder="Enter password">
                                                <div class="input-group-append">
                                                    <button class="btn btn-outline-secondary" type="button"
                                                            id="btnTogglePassword">üëÅÔ∏è</button>
                                                </div>
                                            </div>
                                            <small class="form-text text-muted" id="passwordHint">Required for new employees</small>
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label for="txtConfirmPassword">Confirm Password <span class="text-danger" id="confirmRequired">*</span></label>
                                            <input type="password" class="form-control" id="txtConfirmPassword"
                                                   placeholder="Confirm password">
                                            <small class="form-text text-muted" id="confirmHint">Leave blank to keep existing</small>
                                        </div>
                                    </div>

                                    <!-- Access Level Badge Preview -->
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label>Access Level Preview</label>
                                            <div id="accessLevelPreview" class="p-2 rounded text-center"
                                                 style="background:#f8f9fa; border:2px dashed #dee2e6; min-height:38px;">
                                                <small class="text-muted">Select a position</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Buttons -->
                                <div class="row mt-3">
                                    <div class="col-md-12">
                                        <button type="button" class="btn btn-success" id="btnSave">
                                            üíæ Save Employee
                                        </button>
                                        <button type="button" class="btn btn-primary" id="btnUpdate" style="display:none;">
                                            ‚úèÔ∏è Update Employee
                                        </button>
                                        <button type="button" class="btn btn-danger" id="btnDelete"
                                                style="display:none;" id="btnDelete">
                                            üóëÔ∏è Delete Employee
                                        </button>
                                        <button type="button" class="btn btn-warning" id="btnClear">
                                            üîÑ Clear Form
                                        </button>
                                        <!-- Only owner can delete - hidden for managers -->
                                        <span id="ownerOnlyNote" class="text-muted ml-3" style="display:none;">
                                            <small>‚ö†Ô∏è Only Owners can delete employees</small>
                                        </span>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Search Section -->
            <div class="row mt-4">
                <div class="col-md-12">
                    <div class="card" style="border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,.1); border:none;">
                        <div class="card-header bg-info text-white" style="border-radius:12px 12px 0 0;">
                            <h5 class="mb-0">üîç Search Employees</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Search by Name</label>
                                        <input type="text" class="form-control" id="txtSearchName"
                                               placeholder="Enter employee name">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>Filter by Position</label>
                                        <select class="form-control" id="txtSearchPosition">
                                            <option value="">All Positions</option>
                                            <option value="OWNER">Owner</option>
                                            <option value="MANAGER">Manager</option>
                                            <option value="ASSISTANT_MANAGER">Assistant Manager</option>
                                            <option value="CASHIER">Cashier</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <label>Status</label>
                                        <select class="form-control" id="txtSearchStatus">
                                            <option value="">All</option>
                                            <option value="true">Active</option>
                                            <option value="false">Inactive</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label>&nbsp;</label>
                                        <button type="button" class="btn btn-info btn-block" id="btnSearch">
                                            üîç Search
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Employees Table -->
            <div class="row mt-4 mb-5">
                <div class="col-md-12">
                    <div class="card" style="border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,.1); border:none;">
                        <div class="card-header bg-dark text-white" style="border-radius:12px 12px 0 0;">
                            <h5 class="mb-0">üìã Employee List</h5>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-hover mb-0" id="employeesTable">
                                    <thead class="thead-dark">
                                        <tr>
                                            <th>ID</th>
                                            <th>Name</th>
                                            <th>Position</th>
                                            <th>Username</th>
                                            <th>Email</th>
                                            <th>Phone</th>
                                            <th>Salary</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tblEmployeesBody">
                                        <!-- Rows loaded dynamically -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div><!-- /container -->
    </div><!-- /mainContent -->

    <!-- Footer -->
    <footer class="mt-5 py-3 bg-dark text-white text-center">
        <p>&copy; 2025 POS System. All rights reserved.</p>
    </footer>

    <!-- jQuery & Bootstrap -->
    <script src="js/jquery-3.4.1.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- Controller -->
    <script src="js/manage-employees-controller.js"></script>

</body>
</html>