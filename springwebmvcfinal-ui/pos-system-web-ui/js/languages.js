/**
 * LANGUAGE SYSTEM - Kurdish Default
 */

const translations = {
    ku: {
        // Common
        loading: 'چاوەڕوان بە...',
        save: 'پاشەکەوت',
        cancel: 'هەڵوەشاندنەوە',
        delete: 'سڕینەوە',
        edit: 'دەستکاری',
        add: 'زیادکردن',
        search: 'گەڕان',
        clear: 'پاككردنەوە',

        // Navigation
        nav_home: 'سەرەکی',
        nav_items: 'کاڵاکان',
        nav_employees: 'کارمەندان',
        nav_pos: 'فرۆشتن',
        nav_search: 'قەرزەکان',
        nav_debts: 'قەرزەکان',

        // Brand
        brand_name: 'سیستەمی فرۆشتن',

        // Items
        items_title: 'بەڕێوەبردنی کاڵا',
        items_form_title: 'زانیاری کاڵا',
        items_code: 'کۆدی کاڵا',
        items_name: 'ناوی کاڵا',
        items_category: 'جۆر',
        items_price: 'نرخ',
        items_stock: 'کۆگا',
        items_min_stock: 'کەمترین کۆگا',
        items_barcode: 'بارکۆد',
        items_notes: 'تێبینی',
        items_update: 'نوێکردنەوە',
        items_total: 'کۆی کاڵاکان',
        items_low_stock: 'کۆگای کەم',
        items_out_stock: 'کۆگا نییە',
        items_total_value: 'کۆی نرخ',

        // Debts
        debts_title: 'بەڕێوەبردنی قەرزەکان',
        debts_add: 'زیادکردنی قەرزی نوێ',
        debts_customer_name: 'ناوی کەس',
        debts_phone: 'ژمارە مۆبایل',
        debts_amount: 'بڕی قەرز (IQD)',
        debts_date: 'بەروار',
        debts_notes: 'تێبینی',
        debts_total: 'کۆی قەرز',
        debts_total_paid: 'واردبووی گشتی',
        debts_total_customers: 'ژمارەی قەرزاران',
        debts_status: 'دۆخ',
        debts_status_unpaid: 'قەرز (نەدراوە)',
        debts_status_partial: 'بەشێکی دراوە',
        debts_status_paid: 'تەواو دراوە',
        debts_remaining: 'ماوە',
        debts_paid_amount: 'واردبووی',
        debts_update: 'نوێکردنەوە',
        debts_export: 'دەرهێنان',
        debts_search: 'گەڕان بە ناو یان ژمارە مۆبایل...',
        debts_all_status: 'هەموو دۆخەکان',
        debts_sort_newest: 'نوێترین',
        debts_sort_oldest: 'کۆنترین',
        debts_sort_highest: 'زۆرترین قەرز',
        debts_sort_lowest: 'کەمترین قەرز',
        debts_empty: 'هیچ قەرزێک تۆمار نەکراوە',
        debts_no_result: 'هیچ ئەنجامێک نەدۆزرایەوە',
        debts_confirm_delete: 'دڵنیایت لە سڕینەوەی ئەم قەرزە؟',
        debts_irreversible: 'ئەم کردارە ناگەڕێتەوە!',
        debts_payment_title: 'واردکردنی پارە',
        debts_payment_amount: 'بڕی پارەی وارد (IQD)',
        debts_payment_notes: 'تێبینی',
        debts_confirm: 'دڵنیابوونەوە',

        // Settings
        settings_title: 'ڕێکخستنەکان',
        settings_store: 'ناوی فرۆشگا',
        settings_tax: 'ڕێژەی باج (%)',
        settings_auto_print: 'چاپی خۆکار',
        settings_sound: 'دەنگ لە زیادکردن',
        settings_cashier_name: 'ناوی بەکارهێنەر',
        settings_save: 'پاشەکەوت',
        toggle_on: 'چالاک',
        toggle_off: 'ناچالاک',

        // Calculator
        calc_title: 'ژمێرەر'
    },

    en: {
        // Common
        loading: 'Loading...',
        save: 'Save',
        cancel: 'Cancel',
        delete: 'Delete',
        edit: 'Edit',
        add: 'Add',
        search: 'Search',
        clear: 'Clear',

        // Navigation
        nav_home: 'Home',
        nav_items: 'Items',
        nav_employees: 'Employees',
        nav_pos: 'POS',
        nav_search: 'Debts',
        nav_debts: 'Debts',

        // Brand
        brand_name: 'Sales System',

        // Items
        items_title: 'Inventory Management',
        items_form_title: 'Item Details',
        items_code: 'Item Code',
        items_name: 'Item Name',
        items_category: 'Category',
        items_price: 'Price',
        items_stock: 'Stock',
        items_min_stock: 'Min Stock',
        items_barcode: 'Barcode',
        items_notes: 'Notes',
        items_update: 'Update',
        items_total: 'Total Items',
        items_low_stock: 'Low Stock',
        items_out_stock: 'Out of Stock',
        items_total_value: 'Total Value',

        // Debts
        debts_title: 'Debt Management',
        debts_add: 'Add New Debt',
        debts_customer_name: 'Customer Name',
        debts_phone: 'Phone Number',
        debts_amount: 'Debt Amount (IQD)',
        debts_date: 'Date',
        debts_notes: 'Notes',
        debts_total: 'Total Debt',
        debts_total_paid: 'Total Received',
        debts_total_customers: 'Number of Debtors',
        debts_status: 'Status',
        debts_status_unpaid: 'Unpaid',
        debts_status_partial: 'Partially Paid',
        debts_status_paid: 'Fully Paid',
        debts_remaining: 'Remaining',
        debts_paid_amount: 'Paid',
        debts_update: 'Update',
        debts_export: 'Export',
        debts_search: 'Search by name or phone...',
        debts_all_status: 'All Statuses',
        debts_sort_newest: 'Newest',
        debts_sort_oldest: 'Oldest',
        debts_sort_highest: 'Highest Debt',
        debts_sort_lowest: 'Lowest Debt',
        debts_empty: 'No debts recorded',
        debts_no_result: 'No results found',
        debts_confirm_delete: 'Are you sure you want to delete this debt?',
        debts_irreversible: 'This action cannot be undone!',
        debts_payment_title: 'Record Payment',
        debts_payment_amount: 'Payment Amount (IQD)',
        debts_payment_notes: 'Notes',
        debts_confirm: 'Confirm',

        // Settings
        settings_title: 'Settings',
        settings_store: 'Store Name',
        settings_tax: 'Tax Rate (%)',
        settings_auto_print: 'Auto-print',
        settings_sound: 'Sound',
        settings_cashier_name: 'User Name',
        settings_save: 'Save',
        toggle_on: 'On',
        toggle_off: 'Off',

        // Calculator
        calc_title: 'Calculator'
    },

    ar: {
        // Common
        loading: 'جاري التحميل...',
        save: 'حفظ',
        cancel: 'إلغاء',
        delete: 'حذف',
        edit: 'تعديل',
        add: 'إضافة',
        search: 'بحث',
        clear: 'مسح',

        // Navigation
        nav_home: 'الرئيسية',
        nav_items: 'المنتجات',
        nav_employees: 'الموظفون',
        nav_pos: 'المبيعات',
        nav_search: 'الطلبات',
        nav_debts: 'الديون',

        // Brand
        brand_name: 'نظام المبيعات',

        // Items
        items_title: 'إدارة المخزون',
        items_form_title: 'بيانات المنتج',
        items_code: 'كود المنتج',
        items_name: 'اسم المنتج',
        items_category: 'الفئة',
        items_price: 'السعر',
        items_stock: 'المخزون',
        items_min_stock: 'الحد الأدنى',
        items_barcode: 'الباركود',
        items_notes: 'ملاحظات',
        items_update: 'تحديث',
        items_total: 'إجمالي المنتجات',
        items_low_stock: 'مخزون منخفض',
        items_out_stock: 'نفذ المخزون',
        items_total_value: 'القيمة الإجمالية',

        // Debts
        debts_title: 'إدارة الديون',
        debts_add: 'إضافة دين جديد',
        debts_customer_name: 'اسم الشخص',
        debts_phone: 'رقم الهاتف',
        debts_amount: 'مبلغ الدين (IQD)',
        debts_date: 'التاريخ',
        debts_notes: 'ملاحظات',
        debts_total: 'إجمالي الديون',
        debts_total_paid: 'إجمالي المستلم',
        debts_total_customers: 'عدد المدينين',
        debts_status: 'الحالة',
        debts_status_unpaid: 'غير مدفوع',
        debts_status_partial: 'مدفوع جزئياً',
        debts_status_paid: 'مدفوع بالكامل',
        debts_remaining: 'المتبقي',
        debts_paid_amount: 'المدفوع',
        debts_update: 'تحديث',
        debts_export: 'تصدير',
        debts_search: 'البحث بالاسم أو رقم الهاتف...',
        debts_all_status: 'جميع الحالات',
        debts_sort_newest: 'الأحدث',
        debts_sort_oldest: 'الأقدم',
        debts_sort_highest: 'أعلى دين',
        debts_sort_lowest: 'أدنى دين',
        debts_empty: 'لا توجد ديون مسجلة',
        debts_no_result: 'لا توجد نتائج',
        debts_confirm_delete: 'هل أنت متأكد من حذف هذا الدين؟',
        debts_irreversible: 'لا يمكن التراجع عن هذا الإجراء!',
        debts_payment_title: 'تسجيل دفعة',
        debts_payment_amount: 'مبلغ الدفعة (IQD)',
        debts_payment_notes: 'ملاحظات',
        debts_confirm: 'تأكيد',

        // Settings
        settings_title: 'الإعدادات',
        settings_store: 'اسم المتجر',
        settings_tax: 'معدل الضريبة (%)',
        settings_auto_print: 'طباعة تلقائية',
        settings_sound: 'صوت',
        settings_cashier_name: 'اسم المستخدم',
        settings_save: 'حفظ',
        toggle_on: 'مفعّل',
        toggle_off: 'معطّل',

        // Calculator
        calc_title: 'الآلة الحاسبة'
    }
};

// KURDISH IS DEFAULT
let currentLang = localStorage.getItem('posLang') || 'ku';

function t(key) {
    return translations[currentLang]?.[key] || translations['ku'][key] || key;
}

function setLanguage(lang) {
    if (!translations[lang]) return;
    currentLang = lang;
    localStorage.setItem('posLang', lang);
    document.documentElement.dir = (lang === 'ar' || lang === 'ku') ? 'rtl' : 'ltr';
    document.documentElement.lang = lang;
    translatePage();
    window.dispatchEvent(new CustomEvent('languageChanged', { detail: { lang } }));
}

function translatePage() {
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        const translation = t(key);
        if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
            if (el.type === 'button' || el.type === 'submit') el.value = translation;
            else el.placeholder = translation;
        } else {
            el.textContent = translation;
        }
    });

    // Update language label in navbar
    const labels = { ku: 'کوردی', en: 'English', ar: 'العربية' };
    const labelEl = document.getElementById('currentLangLabel');
    if (labelEl) labelEl.textContent = labels[currentLang] || 'کوردی';
}

// Auto-translate on load
document.addEventListener('DOMContentLoaded', () => {
    const savedLang = localStorage.getItem('posLang') || 'ku';
    setLanguage(savedLang);
});